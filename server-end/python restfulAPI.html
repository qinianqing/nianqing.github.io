<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>python restfulAPI | UKYO TACHIBANA</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
    <meta name="description" content="Hi,我是UKYO TACHIBANA">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <link rel="preload" href="/assets/css/0.styles.f1d2102f.css" as="style"><link rel="preload" href="/assets/js/app.86a58f69.js" as="script"><link rel="preload" href="/assets/js/3.6c57bfa5.js" as="script"><link rel="preload" href="/assets/js/59.6f92874d.js" as="script"><link rel="prefetch" href="/assets/js/10.db98dd9c.js"><link rel="prefetch" href="/assets/js/11.7d9852d4.js"><link rel="prefetch" href="/assets/js/12.2d2e4c5f.js"><link rel="prefetch" href="/assets/js/13.45bd6373.js"><link rel="prefetch" href="/assets/js/14.68e398d6.js"><link rel="prefetch" href="/assets/js/15.3e7de82c.js"><link rel="prefetch" href="/assets/js/16.11219fd1.js"><link rel="prefetch" href="/assets/js/17.bd7d1cb5.js"><link rel="prefetch" href="/assets/js/18.68411687.js"><link rel="prefetch" href="/assets/js/19.c474c824.js"><link rel="prefetch" href="/assets/js/20.c773179c.js"><link rel="prefetch" href="/assets/js/21.f05241df.js"><link rel="prefetch" href="/assets/js/22.0687fc25.js"><link rel="prefetch" href="/assets/js/23.7d444433.js"><link rel="prefetch" href="/assets/js/24.a7a35f66.js"><link rel="prefetch" href="/assets/js/25.638017ef.js"><link rel="prefetch" href="/assets/js/26.49b37614.js"><link rel="prefetch" href="/assets/js/27.b6464189.js"><link rel="prefetch" href="/assets/js/28.cc818800.js"><link rel="prefetch" href="/assets/js/29.e7648d9f.js"><link rel="prefetch" href="/assets/js/30.c9138921.js"><link rel="prefetch" href="/assets/js/31.7c37897b.js"><link rel="prefetch" href="/assets/js/32.f634fe77.js"><link rel="prefetch" href="/assets/js/33.c4db53f6.js"><link rel="prefetch" href="/assets/js/34.eb2fd75c.js"><link rel="prefetch" href="/assets/js/35.0f8d79e7.js"><link rel="prefetch" href="/assets/js/36.d5e7ac48.js"><link rel="prefetch" href="/assets/js/37.c7885a3a.js"><link rel="prefetch" href="/assets/js/38.c98396e2.js"><link rel="prefetch" href="/assets/js/39.2d2fc5a9.js"><link rel="prefetch" href="/assets/js/4.419511d5.js"><link rel="prefetch" href="/assets/js/40.8bf48cc8.js"><link rel="prefetch" href="/assets/js/41.47487868.js"><link rel="prefetch" href="/assets/js/42.e734e815.js"><link rel="prefetch" href="/assets/js/43.0770d103.js"><link rel="prefetch" href="/assets/js/44.736c58d6.js"><link rel="prefetch" href="/assets/js/45.acfb65f4.js"><link rel="prefetch" href="/assets/js/46.2ca5b4e4.js"><link rel="prefetch" href="/assets/js/47.c96ffaa4.js"><link rel="prefetch" href="/assets/js/48.00b26571.js"><link rel="prefetch" href="/assets/js/49.e802fa4b.js"><link rel="prefetch" href="/assets/js/5.d1c5eb45.js"><link rel="prefetch" href="/assets/js/50.80de092a.js"><link rel="prefetch" href="/assets/js/51.1b1e67e3.js"><link rel="prefetch" href="/assets/js/52.b4373a2d.js"><link rel="prefetch" href="/assets/js/53.21f8c0a7.js"><link rel="prefetch" href="/assets/js/54.3a35bf74.js"><link rel="prefetch" href="/assets/js/55.224256a5.js"><link rel="prefetch" href="/assets/js/56.65cbf98f.js"><link rel="prefetch" href="/assets/js/57.f32c3811.js"><link rel="prefetch" href="/assets/js/58.0822c040.js"><link rel="prefetch" href="/assets/js/6.50d2125e.js"><link rel="prefetch" href="/assets/js/7.183450cb.js"><link rel="prefetch" href="/assets/js/8.f4b130f6.js"><link rel="prefetch" href="/assets/js/9.0a539ed4.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.c03d6ca8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f1d2102f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="ant-row"><div class="sidebar-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a href="/" class="router-link-active home-link"><img src="/logo.png" alt="UKYO TACHIBANA" class="logo"> <span class="site-name">UKYO TACHIBANA</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><ul role="menu" id="nav" class="ant-menu ant-menu-horizontal ant-menu-root ant-menu-light"><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/" class="router-link-active">
          首页
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/front-end/">
          🍃前端
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item ant-menu-item-selected"><a href="/server-end/" class="router-link-active">
          👷后端
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          🌿Flutter
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          🌱其他
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          🌈联系
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul> <a href="https://github.com/qinianqing/qinianqing.github.io" target="_blank" rel="noopener noreferrer" class="repo-link"><i aria-label="icon: github" class="anticon anticon-github"><svg viewBox="64 64 896 896" focusable="false" data-icon="github" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></i></a></nav></div></div> <!----></header> <aside class="sidebar"><!----> <ul class="sidebar-links"><li><a href="/server-end/" class="sidebar-link">后端</a></li><li><a href="/server-end/python restfulAPI.html" class="active sidebar-link">python restfulAPI</a><ul class="sidebar-sub-headers"></ul></li></ul></aside> <main class="page"> <div class="theme-antdocs-content content__default"><h3 id="为何要用python"><a href="#为何要用python" class="header-anchor">#</a> 为何要用Python?</h3> <p>最近公司大屏项目，之前用的node.js，数据量大了之后，还是有瓶颈的，并且js太灵活，没有好的代码风格控制，当然，还有其他的原因哈，就不一一介绍python了，去官网看就好。</p> <h3 id="让我们开始吧"><a href="#让我们开始吧" class="header-anchor">#</a> 让我们开始吧!</h3> <h4 id="下载python"><a href="#下载python" class="header-anchor">#</a> <a href="https://www.python.org/" target="_blank" rel="noopener noreferrer">下载python<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h4> <h4 id="python基础"><a href="#python基础" class="header-anchor">#</a> <a href="https://www.runoob.com/python3/python3-interpreter.html" target="_blank" rel="noopener noreferrer">python基础<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h4> <h4 id="django-rest-framework"><a href="#django-rest-framework" class="header-anchor">#</a> <a href="https://www.django-rest-framework.org/" target="_blank" rel="noopener noreferrer">Django Rest framework<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h4> <ol><li><h4 id="安装所需要的包"><a href="#安装所需要的包" class="header-anchor">#</a> 安装所需要的包</h4></li></ol> <div class="language- extra-class"><pre class="language-text"><code>pip3  install django
pip3 install djangorestframework

</code></pre></div><ol start="2"><li><h4 id="用-djiango创建项目"><a href="#用-djiango创建项目" class="header-anchor">#</a> <a href="https://docs.djangoproject.com/en/3.0/" target="_blank" rel="noopener noreferrer">用 Djiango创建项目<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h4></li></ol> <div class="language- extra-class"><pre class="language-text"><code>django-admin startproject djangoDemo
&lt;!-- 目录结构 --&gt;
djangoDemo/
├── djangoDemo  //项目最初的Python包
│   ├── __init__.py  //一个空文件，声明所在目录的包为一个Python包
│   ├── settings.py // 管理项目的配置信息
│   ├── urls.py //声明请求url的映射关系
│   └── wsgi.py //python程序和web服务器的通信协议
└── manage.py // 一个命令行工具，用来和Django项目进行交互，如前面创建项目就用到了该文件
</code></pre></div><ol start="3"><li><h4 id="讲下-settings-py"><a href="#讲下-settings-py" class="header-anchor">#</a> 讲下 settings.py</h4></li></ol> <div class="language- extra-class"><pre class="language-text"><code>import os

# 项目的相对路径，启动服务的时候会运行这个文件所在路径的manage.py
BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))

# 安全密钥
SECRET_KEY = 'l&amp;!v_npes(!j82+x(44vt+h&amp;#ag7io2x&amp;shnf*9^8fv0d63!0r'

# 是否开启Debug
DEBUG = True

# 允许访问的主机ip，可以用通配符*
ALLOWED_HOSTS = []

# Application definition
# 用来注册App 前6个是django自带的应用
INSTALLED_APPS = [
   'django.contrib.admin',
   'django.contrib.auth',
   'django.contrib.contenttypes',
   'django.contrib.sessions',
   'django.contrib.messages’,
   'django.contrib.staticfiles’,
]
# 中间件 ,需要加载的中间件。比如在请求前和响应后根据规则去执行某些代码的方法
MIDDLEWARE = [
   'django.middleware.security.SecurityMiddleware',
   'django.contrib.sessions.middleware.SessionMiddleware',
   'django.middleware.common.CommonMiddleware',
   'django.middleware.csrf.CsrfViewMiddleware',
   'django.contrib.auth.middleware.AuthenticationMiddleware',
   'django.contrib.messages.middleware.MessageMiddleware',
   'django.middleware.clickjacking.XFrameOptionsMiddleware',
]


# 指定URL列表文件 父级URL配置
ROOT_URLCONF = 'djangoDemo.urls’

# 加载网页模板路径
TEMPLATES = [
   {
       'BACKEND': 'django.template.backends.django.DjangoTemplates',
       'DIRS': [],
       'APP_DIRS': True,
       'OPTIONS': {
           'context_processors': [
               'django.template.context_processors.debug',
               'django.template.context_processors.request',
               'django.contrib.auth.context_processors.auth',
               'django.contrib.messages.context_processors.messages',
           ],
       },
   },
]

# WSGI的配置文件路径
WSGI_APPLICATION = 'djangoDemo.wsgi.application'

# 数据库配置 默认的数据库为sqlite
DATABASES = {
   'default': {
       'ENGINE': 'django.db.backends.sqlite3',
       'NAME': os.path.join(BASE_DIR, 'db.sqlite3'),
   }
}


# 相关密码验证
AUTH_PASSWORD_VALIDATORS = [
   {
       'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
   },
   {
       'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
   },
   {
       'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
   },
  {
       'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
   },
]


# 语言设置 默认英语， 中文是zh-hans
LANGUAGE_CODE = 'en-us'

# 时区设置，中国的是：Asia/Shanghai
TIME_ZONE = 'UTC'

# i18n字符集是否支持
USE_I18N = True

USE_L10N = True

# 是否使用timezone
# 保证存储到数据库中的是 UTC 时间；
# 在函数之间传递时间参数时，确保时间已经转换成 UTC 时间；
USE_TZ = True

# 静态文件路径
STATIC_URL = '/static/'
</code></pre></div><ol start="4"><li><h4 id="创建模块"><a href="#创建模块" class="header-anchor">#</a> 创建模块</h4></li></ol> <div class="language- extra-class"><pre class="language-text"><code>创建一个名为app_demo的应用
   django-admin startapp app_demo

目录
├── app_demo
│   ├── __init__.py
│   ├── admin.py
│   ├── apps.py
│   ├── migrations
│   │   └── __init__.py
│   ├── models.py
│   ├── tests.py
│   └── views.py
├── djangoDemo
│   ├── __init__.py
│   ├── settings.py
│   ├── urls.py
│   └── wsgi.py
└── manage.py

</code></pre></div><ol start="5"><li><h4 id="app-demo目录结构"><a href="#app-demo目录结构" class="header-anchor">#</a> app_demo目录结构</h4></li></ol> <div class="language- extra-class"><pre class="language-text"><code>app_demo目录结构

admin:对应应用后台管理配置文件

apps:对应应用的配置文件

models:数据模块，用于设计数据库等

tests:编写测试脚本

views：视图层，直接和浏览器进行交互

每次新建一个App我们需要将其在settings.py文件中的INSTALLED_APPS里进行注册，这样程序才能够找到这个服务

INSTALLED_APPS = [
   'django.contrib.admin',
   'django.contrib.auth',
   'django.contrib.contenttypes',
   'django.contrib.sessions',
   'django.contrib.messages',
   'django.contrib.staticfiles',
   'app_demo', # 注册新创建的应用app
]

</code></pre></div><ol start="6"><li><h4 id="打开app-demo目录下的view-py，编写视图"><a href="#打开app-demo目录下的view-py，编写视图" class="header-anchor">#</a> 打开app_demo目录下的view.py，编写视图</h4></li></ol> <div class="language- extra-class"><pre class="language-text"><code>from django.shortcuts import render
from django.http import HttpResponse

def hello(request):
   return HttpResponse('Hello World')

</code></pre></div><ol start="7"><li><h4 id="打开djiangodemo的urls-py"><a href="#打开djiangodemo的urls-py" class="header-anchor">#</a> 打开DjiangoDemo的urls.py</h4></li></ol> <div class="language- extra-class"><pre class="language-text"><code>映射URL
主页的URL，它是用户用来访问项目的基础URL

from django.contrib import admin
from django.urls import path, include

urlpatterns = [    
   path('admin/', admin.site.urls),    
   path('', include('app_demo.urls')),
]
</code></pre></div><ol start="8"><li><h4 id="在文件夹app-demo中创建另一个urls-py文件"><a href="#在文件夹app-demo中创建另一个urls-py文件" class="header-anchor">#</a> 在文件夹app_demo中创建另一个urls.py文件</h4></li></ol> <div class="language- extra-class"><pre class="language-text"><code>from django.urls import path
from . import views

app_name='app_demo’
urlpatterns = [
   path('hello', views.hello, name=‘hello'),
]
</code></pre></div><ol start="9"><li><h4 id="执行如下命令来启动项目-大概一个项目就跑起来了"><a href="#执行如下命令来启动项目-大概一个项目就跑起来了" class="header-anchor">#</a> 执行如下命令来启动项目,大概一个项目就跑起来了</h4></li></ol> <div class="language- extra-class"><pre class="language-text"><code>python3 manage.py runserver  8000 
</code></pre></div><h3 id="下面是一些正式开发需要注意的！"><a href="#下面是一些正式开发需要注意的！" class="header-anchor">#</a> 下面是一些正式开发需要注意的！</h3> <h4 id="连接数据库，定义模型"><a href="#连接数据库，定义模型" class="header-anchor">#</a> 连接数据库，定义模型</h4> <div class="language- extra-class"><pre><code>1.settings.py的MySQL连接信息，如下
 ``` 
  import pymysql
  pymysql.install_as_MySQLdb()

  DATABASES = {
      'default': {
          ‘ENGINE’: ‘django.db.backends.mysql’,  # 数据库引擎
          ‘NAME’: ‘test’,                          #  数据库名，事先要创建
          ‘USER’: ‘test’,		      #  用户名
          ‘PASSWORD’: ‘test123’,           #   密码
          ‘HOST’:‘localhost’,                   #   主机
          ‘PORT’:‘3306’,	                      #   数据库端口
      }
  }

 ```
2.定义模型 model.py
 ```
from django.db import models

class Musician(models.Model):
      first_name = models.CharField(max_length=50)
      last_name = models.CharField(max_length=50)
      instrument = models.CharField(max_length=100)

class Album(models.Model):
      artist = models.ForeignKey(Musician, on_delete=models.CASCADE)
      name = models.CharField(max_length=100)
      release_date = models.DateField()
      num_stars = models.IntegerField()

python3 manage.py makemigrations app_demo    # 生成迁移文件
python3 manage.py migrate   # 执行迁移文件

 ``` 
</code></pre></div><h4 id="restful设计方法"><a href="#restful设计方法" class="header-anchor">#</a> RESTful设计方法</h4> <div class="language- extra-class"><pre><code>1.域名
 应该尽量将API部署在专用域名之下。
   https://api.example.com
   如果确定API很简单，不会有进一步扩展，可以考虑放在主域名下。
   https://example.org/api/

2.版本（Versioning）
应该将API的版本号放入URL。
http://www.example.com/api/1.0/foo
http://www.example.com/api/1.1/foo
http://www.example.com/api/2.0/foo

另一种做法是，将版本号放在HTTP头信息中，但不如放入URL方便和直观。
因为不同的版本，可以理解成同一种资源的不同表现形式，所以应该采用同一个URL。版本号可以在HTTP请求头信息的Accept字
段中进行区分（参见Versioning REST Services）：
Accept: vnd.example-com.foo+json; version=1.0

Accept: vnd.example-com.foo+json; version=1.1

Accept: vnd.example-com.foo+json; version=2.0

3.路径
路径又称&quot;终点&quot;（endpoint），表示API的具体网址，每个网址代表一种资源（resource）

(1) 资源作为网址，只能有名词，不能有动词，而且所用的名词往往与数据库的表名对应。
举例来说，以下是不好的例子:
  /getProducts 
  /listOrders 
  /retreiveClientByOrder?orderId=1

对于一个简洁结构，你应该始终用名词。 此外，利用的HTTP方法可以分离网址中的资源名称的操作。

  GET /products ：将返回所有产品清单 
  POST /products ：将产品新建到集合 
  GET /products/4 ：将获取产品 4 
  PATCH（或）PUT /products/4 ：将更新产品 4

(2) API中的名词应该使用复数。无论子资源或者所有资源。
举例来说，获取产品的API可以这样定义
  获取单个产品：http://127.0.0.1:8080/AppName/rest/products/1 
  获取所有产品: http://127.0.0.1:8080/AppName/rest/products
</code></pre></div><ol start="4"><li>HTTP动词
路径又称&quot;终点&quot;（endpoint），表示API的具体网址，每个网址代表一种资源（resource）</li></ol> <div class="language- extra-class"><pre><code>(1) 资源作为网址，只能有名词，不能有动词，而且所用的名词往往与数据库的表名对应。
举例来说，以下是不好的例子:
  /getProducts 
  /listOrders 
  /retreiveClientByOrder?orderId=1

对于一个简洁结构，你应该始终用名词。 此外，利用的HTTP方法可以分离网址中的资源名称的操作。

  GET /products ：将返回所有产品清单 
  POST /products ：将产品新建到集合 
  GET /products/4 ：将获取产品 4 
  PATCH（或）PUT /products/4 ：将更新产品 4

(2) API中的名词应该使用复数。无论子资源或者所有资源。
举例来说，获取产品的API可以这样定义
  获取单个产品：http://127.0.0.1:8080/AppName/rest/products/1 
  获取所有产品: http://127.0.0.1:8080/AppName/rest/products
</code></pre></div><ol start="5"><li><p>过滤信息（Filtering）
如果记录数量很多，服务器不可能都将它们返回给用户。API应该提供参数，过滤返回结果。
下面是一些常见的参数。
?limit=10：指定返回记录的数量
?offset=10：指定返回记录的开始位置。
?page=2&amp;per_page=100：指定第几页，以及每页的记录数。
?sortby=name&amp;order=asc：指定返回结果按照哪个属性排序，以及排序顺序。
?animal_type_id=1：指定筛选条件</p></li> <li><p>状态码（Status Codes）
服务器向用户返回的状态码和提示信息，常见的有以下一些（方括号中是该状态码对应的HTTP动词）
200 OK - [GET]：服务器成功返回用户请求的数据
201 CREATED - [POST/PUT/PATCH]：用户新建或修改数据成功。
202 Accepted - [<em>]：表示一个请求已经进入后台排队（异步任务）
204 NO CONTENT - [DELETE]：用户删除数据成功。
400 INVALID REQUEST - [POST/PUT/PATCH]：用户发出的请求有错误，服务器没有进行新建或修改数据的操作
401 Unauthorized - [</em>]：表示用户没有权限（令牌、用户名、密码错误）。
403 Forbidden - [<em>] 表示用户得到授权（与401错误相对），但是访问是被禁止的。
404 NOT FOUND - [</em>]：用户发出的请求针对的是不存在的记录，服务器没有进行操作，该操作是幂等的。
406 Not Acceptable - [GET]：用户请求的格式不可得（比如用户请求JSON格式，但是只有XML格式）。
410 Gone -[GET]：用户请求的资源被永久删除，且不会再得到的。
422 Unprocesable entity - [POST/PUT/PATCH] 当创建一个对象时，发生一个验证错误。
500 INTERNAL SERVER ERROR - [*]：服务器发生错误，用户将无法判断发出的请求是否成功。</p></li> <li><p>错误处理（Error handling）
如果状态码是4xx，服务器就应该向用户返回出错信息。一般来说，返回的信
息中将error作为键名，出错信息作为键值即可。
{
error: &quot;Invalid API key“
}</p></li> <li><p>返回结果
针对不同操作，服务器向用户返回的结果应该符合以下规范。
GET /collection：返回资源对象的列表（数组）
GET /collection/resource：返回单个资源对象
POST /collection：返回新生成的资源对象
PUT /collection/resource：返回完整的资源对象
PATCH /collection/resource：返回完整的资源对象
DELETE /collection/resource：返回一个空文档</p></li> <li><p>超媒体（Hypermedia API）
RESTful API最好做到Hypermedia（即返回结果中提供链接，连向其他API方法），使得用户不查文档，也知道
下一步应该做什么。比如，Github的API就是这种设计，访问api.github.com会得到一个所有可用API的网址列表。
{
&quot;current_user_url&quot;: &quot;https://api.github.com/user&quot;,
&quot;authorizations_url&quot;: &quot;https://api.github.com/authorizations&quot;,
// ...
}</p> <p>从上面可以看到，如果想获取当前用户的信息，应该去访问api.github.com/user，然后就得到了下面结果。
{
&quot;message&quot;: &quot;Requires authentication&quot;,
&quot;documentation_url&quot;: &quot;https://developer.github.com/v3&quot;
}
上面代码表示，服务器给出了提示信息，以及文档的网址。</p></li> <li><p>其他
服务器返回的数据格式，应该尽量使用JSON，避免使用XML。</p></li></ol> <h3 id="django-rest-framework-2"><a href="#django-rest-framework-2" class="header-anchor">#</a> <a href="https://www.django-rest-framework.org/" target="_blank" rel="noopener noreferrer">Django REST framework<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h3> <h4 id="fbv-模式"><a href="#fbv-模式" class="header-anchor">#</a> FBV 模式</h4> <div class="language- extra-class"><pre><code>```
  #url
  from django.contrib import admin
  from django.urls import path
  from app01 import views
   
  urlpatterns = [
      path('admin/', admin.site.urls),
      # 基于函数的视图
      path('user/',views.user)
  ]
  
  # view
  from django.shortcuts import render,HttpResponse
  import json
   
  # FBV 模式
  def user(request):
      '''
      如果有不同的方法 则要进行不同的判断
      '''
      if request.method == &quot;GET&quot;:
          return HttpResponse(&quot;GET&quot;)
   
      if request.method == &quot;POST&quot;:
          return HttpResponse(&quot;POST&quot;)
```
</code></pre></div><h4 id="cbv-模式-一般开发用这个模式"><a href="#cbv-模式-一般开发用这个模式" class="header-anchor">#</a> CBV 模式(一般开发用这个模式)</h4> <div class="language- extra-class"><pre class="language-text"><code>  # url
  from django.contrib import admin
  from django.urls import path
  from app01 import views
   
  urlpatterns = [
      path('admin/', admin.site.urls),
       
      # CBV模式
      path('people',views.PeopleView.as_view())  # 后面的as_view()要记得写上
  ]
   
  # view
  '''
  CBV模式需要继承View
  当请求是get时候 自动执行get方法 
  当请求是post的时候 自动执行post方法
  '''
   
  from django.views import View
   
  # 所有CBV的都必须继承View
  class PeopleView(View):  # 一般喜欢在后面加个View
   
      def get(self,request,*args,**kwargs):
          return HttpResponse(&quot;GET&quot;)
   
      def post(self,request,*args,**kwargs):
          return HttpResponse(&quot;POST&quot;)

</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/qinianqing/qinianqing.github.io/edit/master/server-end/python restfulAPI.md" target="_blank" rel="noopener noreferrer">帮助我改善这个页面</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">6/23/2020, 6:18:31 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/server-end/" class="prev router-link-active"><i aria-label="icon: left" class="anticon anticon-left"><svg viewBox="64 64 896 896" focusable="false" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i>
        后端
      </a></span> <!----></p></div> </main> <!----></div><div class="global-ui"><div class="reading-progress top" data-v-21b39eda><div class="progress" data-v-21b39eda></div></div><div id="goTop" class="hide-cat" data-v-3cd57a9e></div></div></div>
    <script src="/assets/js/app.86a58f69.js" defer></script><script src="/assets/js/3.6c57bfa5.js" defer></script><script src="/assets/js/59.6f92874d.js" defer></script>
  </body>
</html>